<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>CTF Zone - Level 3 (Final)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        /* --- GIAO DI·ªÜN DARK MODE --- */
        body { background-color: #0d1117; color: #e3b341; font-family: 'Courier New', monospace; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; border: 1px solid #e3b341; padding: 20px; position: relative; box-shadow: 0 0 15px #e3b341; }
        
        h1 { border-bottom: 1px solid #e3b341; margin-top: 0; }
        .challenge { margin-top: 30px; }
        
        input { 
            background: #0d1117; border: 1px solid #e3b341; color: white; 
            padding: 12px; width: 60%; font-family: inherit; border-radius: 4px; outline: none;
        }
        input:focus { box-shadow: 0 0 5px #e3b341; }
        input.solved { border-color: #3fb950; color: #3fb950; font-weight: bold; background: #0d1117; }
        
        button { 
            background: #e3b341; color: black; border: none; 
            padding: 12px 25px; font-weight: bold; cursor: pointer; border-radius: 4px; margin-left: 10px;
        }
        button:hover { background: #f0c64d; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .hint { color: #8b949e; font-style: italic; margin-top: 15px; border-left: 3px solid #8b949e; padding-left: 10px; }
        .result { margin-top: 15px; font-weight: bold; font-size: 1.1em; min-height: 24px; }
        
        .reset-btn {
            position: absolute; top: 20px; right: 20px;
            background: #da3633; font-size: 0.8em; padding: 5px 10px; border-radius: 4px; color: white; border: none; cursor: pointer;
        }
        .back-link { color: #8b949e; text-decoration: none; display: inline-block; margin-bottom: 20px; }
        .back-link:hover { color: white; }
    </style>
</head>
<body>
    <div class="container">
        <button onclick="resetGame()" class="reset-btn">üîÑ Reset All</button>
        <a href="CTF12.html" class="back-link">&larr; Quay l·∫°i Level 1 & 2</a>
        
        <h1>‚ö†Ô∏è LEVEL 3: KHU V·ª∞C C·∫§M</h1>

        <div class="challenge">
            <h3>Nhi·ªám v·ª•: X√¢m nh·∫≠p v√†o trang ·∫©n</h3>
            <p>Nh·ªØng con Robots n·∫±m ·ªü ƒë√¢u?</p>
            
            <p class="hint">
                üí° G·ª£i √Ω: Ph·∫ßn n√†o c·ªßa trang web c√≥ th·ªÉ cho b·∫°n bi·∫øt n∆°i m√† ng∆∞·ªùi t·∫°o ra trang web kh√¥ng mu·ªën b·∫°n xem?
            </p>
            
            <br>
            <input type="text" id="ans3" placeholder="Nh·∫≠p Flag t√¨m ƒë∆∞·ª£c t·∫°i ƒë√¢y...">
            <button id="btn3" onclick="check()">G·ª≠i ƒë√°p √°n</button>
            <div id="res" class="result"></div>
        </div>
    </div>

    <script>
        // --- C·∫§U H√åNH B·∫¢O M·∫¨T (MD5 HASH) ---
        const correctHash = "036808170ec1270785075db9534fca6a";

        window.onload = function() {
            if (localStorage.getItem('ctf_level_3') === 'solved') {
                updateUI();
            }
        };

        function check() {
            let inputField = document.getElementById('ans3');
            let resBox = document.getElementById('res');
            let userInput = inputField.value.trim(); // X√≥a kho·∫£ng tr·∫Øng th·ª´a

            // Ki·ªÉm tra th∆∞ vi·ªán
            if (typeof CryptoJS === 'undefined') {
                resBox.innerHTML = "L·ªói: Kh√¥ng t·∫£i ƒë∆∞·ª£c th∆∞ vi·ªán m√£ h√≥a (C·∫ßn c√≥ m·∫°ng Internet).";
                return;
            }

            // M√£ h√≥a input ng∆∞·ªùi d√πng
            let userHash = CryptoJS.MD5(userInput).toString();

            if (userHash === correctHash) {
                localStorage.setItem('ctf_level_3', 'solved');
                
                // Khi ng∆∞·ªùi d√πng v·ª´a nh·∫≠p ƒë√∫ng, ta gi·ªØ nguy√™n c√°i h·ªç v·ª´a nh·∫≠p ƒë·ªÉ h·ªç th·∫•y
                // Nh∆∞ng ta g·ªçi updateUI ƒë·ªÉ kh√≥a l·∫°i
                updateUI(true); 
            } else {
                resBox.innerHTML = "Sai r·ªìi! ‚ùå";
                resBox.style.color = "#f85149";
                inputField.style.borderColor = "#f85149";
                setTimeout(() => { inputField.style.borderColor = "#e3b341"; }, 500);
            }
        }

        // Tham s·ªë 'justSolved' ƒë·ªÉ bi·∫øt l√† ng∆∞·ªùi d√πng v·ª´a m·ªõi gi·∫£i xong hay l√† load l·∫°i trang
        function updateUI(justSolved = false) {
            let input = document.getElementById('ans3');
            let btn = document.getElementById('btn3');
            let resBox = document.getElementById('res');

            // --- S·ª¨A L·ªñI ·ªû ƒê√ÇY ---
            // Thay v√¨ ƒëi·ªÅn Flag v√†o, ch√∫ng ta ƒëi·ªÅn m·ªôt chu·ªói ·∫©n danh
            if (!justSolved) {
                input.value = "******************"; // Che ƒë√°p √°n ƒëi khi F5
            }
            // N·∫øu justSolved = true th√¨ gi·ªØ nguy√™n c√°i ng∆∞·ªùi d√πng ƒëang nh·∫≠p
            
            input.classList.add('solved');
            input.disabled = true;
            btn.disabled = true;
            btn.innerText = "ƒê√£ gi·∫£i";
            
            resBox.innerHTML = "XU·∫§T S·∫ÆC! üéâ B·∫°n ƒë√£ ho√†n th√†nh nhi·ªám v·ª•.";
            resBox.style.color = "#3fb950";
        }

        function resetGame() {
            if(confirm("X√≥a to√†n b·ªô ti·∫øn ƒë·ªô v√† ch∆°i l·∫°i t·ª´ ƒë·∫ßu?")) {
                localStorage.clear();
                window.location.href = "CTF3.html";
            }
        }
    </script>
</body>
</html>
